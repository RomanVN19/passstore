{"version":3,"sources":["katejs-memory/lib/forms/CacheControl.js","katejs-memory/lib/AppClient.js","katejs-memory/lib/structure.js","forms/AccountList.js","forms/AccountItem.js","structure.js","icons.js","AppClient.js","index.js","translations.js"],"names":["CacheControl","args","title","save","app","memory","elements","type","Elements","BUTTON","onClick","Form","AppClient","parent","params","forms","makeApiLinks","entities","window","localStorage","setItem","this","memoryCollectMode","menu","push","form","url","uri","replace","baseUrl","body","JSON","stringify","auth","authorization","memItem","find","item","response","console","log","length","error","message","use","package","actions","disabled","unshift","GRID","LABEL","style","textAlign","marginTop","getElement","name","Fields","REFERENCE","entity","onChange","val","projectChange","currentProject","filters","projectUuid","uuid","get","value","project","content","__Add","allow","load","forEach","action","index","hidden","tag","id","ProjectRole","fields","STRING","Project","tables","Account","structures","ProjectList","xmlns","version","width","height","viewBox","d","ProjectRoleList","AccountList","env","apiUrl","init","addToMenu","AccountItem","saveAuth","menuItem","rule","method","icons","icon","AppUser","AppMemory","KateJSClient","translations","undefined"],"mappings":"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","file":"static/js/main.39a9407c.chunk.js","sourcesContent":["import { Form, Elements } from 'katejs/lib/client';\n\nexport default class CacheControl extends Form {\n  title = 'Cache control';\n\n  constructor(args) {\n    super(args);\n    this.elements = [\n      {\n        type: Elements.BUTTON,\n        title: 'Save cache',\n        onClick: this.save,\n      },\n    ];\n  }\n\n  save = () => {\n    this.app.CacheControl.save(this.app.memory);\n  }\n}\n","import { use } from 'katejs/lib/client';\n\nimport { packageName } from './structure';\nimport CacheControl from './forms/CacheControl';\n\nconst AppClient = parent => class Client extends use(parent) {\n  constructor(params) {\n    super(params);\n\n    this.forms = {\n      ...this.forms,\n      CacheControl,\n    };\n    this.makeApiLinks({ entities: ['CacheControl'] });\n    this.memory = [];\n    // set same device for all to proceed auth\n    window.localStorage.setItem('katejs-user-device', 'device-12345');\n  }\n\n  afterInit() {\n    if (super.afterInit) super.afterInit();\n    if (this.memoryCollectMode) {\n      this.menu.push({\n        form: 'CacheControl',\n        title: 'Cache control',\n      });\n    }\n  }\n\n  async request(url, params) {\n    const uri = url.replace(this.baseUrl, '');\n    const body = JSON.stringify(params.body);\n    const auth = this.authorization;\n    const memItem = this.memory.find(item => item.uri === uri\n      && item.body === body && item.auth === auth);\n    \n    let response;\n    if (this.memoryCollectMode) {\n      response = await super.request(url, params);\n      if (uri === '/CacheControl/save') return response;\n      if (memItem) {\n        memItem.response = response;\n      } else {\n        this.memory.push({\n          uri,\n          body,\n          auth,\n          response,\n        });\n        // eslint-disable-next-line no-console\n        console.log(`Added to cache (${this.memory.length})`);\n      }\n    } else if (memItem) {\n      // return saved data\n      // eslint-disable-next-line prefer-destructuring\n      response = memItem.response;\n    } else {\n      response = { error: { message: 'No data' } };\n    }\n    return response;\n  }\n};\nAppClient.package = packageName;\nexport default AppClient;\n","// eslint-disable-next-line import/prefer-default-export\nexport const packageName = 'katejs-memory';\n","import { Elements, getElement } from 'katejs/lib/client';\nimport Fields from 'katejs/lib/fields';\n\nexport default Form => class AccountList extends Form {\n  constructor(args) {\n    super(args);\n    this.actions[0].disabled = true;\n    this.elements.unshift({\n      type: Elements.GRID,\n      elements: [\n        {\n          type: Elements.LABEL,\n          title: 'Select project:',\n          style: { textAlign: 'right', marginTop: '30px' },\n        },\n        {\n          ...getElement({ name: 'project', type: Fields.REFERENCE, entity: 'Project' }, this),\n          onChange: val => this.projectChange(val),\n        },\n      ],\n    });\n    if (this.app.currentProject) {\n      this.filters = { projectUuid: this.app.currentProject.uuid };\n      this.elements.get('project').value = this.app.currentProject;\n      this.actions[0].disabled = false;\n    }\n  }\n\n  projectChange(project) {\n    this.filters = { projectUuid: project && project.uuid };\n    this.content.__Add.disabled = !project || !this.app.allow('Account', 'put');\n    // to use in edit form\n    this.app.currentProject = project;\n    this.load();\n  }\n};\n","import { Elements } from 'katejs/lib/client';\n\nexport default Form => class AccountItem extends Form {\n  constructor(args) {\n    super(args);\n\n    this.elements.get('project').value = this.app.currentProject;\n    if (!this.app.allow('Account', 'put')) {\n      // user can only view\n      this.actions.forEach((action, index) => {\n        if (index === this.actions.length - 1) return;\n        // eslint-disable-next-line no-param-reassign\n        action.hidden = true;\n      });\n      // value will be set by id\n      this.elements = [\n        {\n          type: Elements.LABEL,\n          tag: 'h3',\n          id: 'title',\n        },\n        {\n          type: Elements.LABEL,\n          id: 'description',\n        },\n        {\n          type: Elements.GRID,\n          elements: [\n            {\n              type: Elements.LABEL,\n              title: 'Uri',\n            },\n            {\n              type: Elements.LABEL,\n              id: 'uri',\n            },\n          ],\n        },\n        {\n          type: Elements.GRID,\n          elements: [\n            {\n              type: Elements.LABEL,\n              title: 'Login',\n            },\n            {\n              type: Elements.LABEL,\n              id: 'login',\n            },\n          ],\n        },\n        {\n          type: Elements.GRID,\n          elements: [\n            {\n              type: Elements.LABEL,\n              title: 'Password',\n            },\n            {\n              type: Elements.LABEL,\n              id: 'password',\n            },\n          ],\n        },\n      ];\n    }\n  }\n};\n","import Fields from 'katejs/lib/fields';\n\nconst ProjectRole = {\n  fields: [\n    {\n      name: 'title',\n      type: Fields.STRING,\n    },\n  ],\n};\n\nconst Project = {\n  fields: [\n    {\n      name: 'title',\n      type: Fields.STRING,\n    },\n  ],\n  tables: [\n    {\n      name: 'users',\n      fields: [\n        {\n          name: 'user',\n          type: Fields.REFERENCE,\n          entity: 'User',\n        },\n        {\n          name: 'role',\n          type: Fields.REFERENCE,\n          entity: 'ProjectRole',\n        },\n      ],\n    },\n  ],\n};\n\nconst Account = {\n  fields: [\n    {\n      name: 'title',\n      type: Fields.STRING,\n    },\n    {\n      name: 'project',\n      type: Fields.REFERENCE,\n      entity: 'Project',\n    },\n    {\n      name: 'description',\n      type: Fields.STRING,\n    },\n    {\n      name: 'url',\n      type: Fields.STRING,\n    },\n    {\n      name: 'login',\n      type: Fields.STRING,\n    },\n    {\n      name: 'password',\n      type: Fields.STRING,\n    },\n  ],\n  tables: [\n    {\n      name: 'availableFor',\n      fields: [\n        {\n          name: 'role',\n          type: Fields.REFERENCE,\n          entity: 'ProjectRole',\n        },\n      ],\n    },\n  ],\n};\n\n\nexport const title = 'Passstore';\nexport const packageName = 'passstore_app';\nexport const structures = {\n  ProjectRole,\n  Project,\n  Account,\n};\n","// eslint-disable-next-line import/no-extraneous-dependencies\nimport React from 'react';\n\nconst ProjectList = () => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n    <path d=\"M9,5V9H21V5M9,19H21V15H9M9,14H21V10H9M4,9H8V5H4M4,19H8V15H4M4,14H8V10H4V14Z\" />\n  </svg>\n);\n\nconst ProjectRoleList = () => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n    <path d=\"M13.07 10.41A5 5 0 0 0 13.07 4.59A3.39 3.39 0 0 1 15 4A3.5 3.5 0 0 1 15 11A3.39 3.39 0 0 1 13.07 10.41M5.5 7.5A3.5 3.5 0 1 1 9 11A3.5 3.5 0 0 1 5.5 7.5M7.5 7.5A1.5 1.5 0 1 0 9 6A1.5 1.5 0 0 0 7.5 7.5M16 17V19H2V17S2 13 9 13 16 17 16 17M14 17C13.86 16.22 12.67 15 9 15S4.07 16.31 4 17M15.95 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13Z\" />\n  </svg>\n);\n\nconst AccountList = () => (\n  <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n    <path d=\"M6.5,2C8.46,2 10.13,3.25 10.74,5H22V8H18V11H15V8H10.74C10.13,9.75 8.46,11 6.5,11C4,11 2,9 2,6.5C2,4 4,2 6.5,2M6.5,5A1.5,1.5 0 0,0 5,6.5A1.5,1.5 0 0,0 6.5,8A1.5,1.5 0 0,0 8,6.5A1.5,1.5 0 0,0 6.5,5M6.5,13C8.46,13 10.13,14.25 10.74,16H22V19H20V22H18V19H16V22H13V19H10.74C10.13,20.75 8.46,22 6.5,22C4,22 2,20 2,17.5C2,15 4,13 6.5,13M6.5,16A1.5,1.5 0 0,0 5,17.5A1.5,1.5 0 0,0 6.5,19A1.5,1.5 0 0,0 8,17.5A1.5,1.5 0 0,0 6.5,16Z\" />\n  </svg>\n);\n\nexport default {\n  ProjectList,\n  ProjectRoleList,\n  AccountList,\n};\n","import { use } from 'katejs/lib/client';\nimport { AppUser } from 'katejs-modules/lib/client';\n\nimport { AppMemory } from 'katejs-memory/lib/client';\n\nimport AccountList from './forms/AccountList';\nimport AccountItem from './forms/AccountItem';\n\nimport { structures, title, packageName } from './structure';\nimport env from './front.env.json';\nimport icons from './icons';\n\nimport memory from './memory.json';\n\nconst AppClient = parent => class Client extends use(parent, AppUser, AppMemory) {\n  static title = title;\n\n  constructor(params) {\n    super(params);\n    this.baseUrl = env.apiUrl || '/api';\n\n    this.init({ structures, addToMenu: true });\n\n    this.forms = {\n      ...this.forms,\n      AccountList: AccountList(this.forms.AccountList),\n      AccountItem: AccountItem(this.forms.AccountItem),\n    };\n\n    this.saveAuth = true;\n    this.menu.forEach((menuItem) => {\n      if (this.forms[menuItem.form].entity && this.forms[menuItem.form].entity !== 'Account') {\n        // eslint-disable-next-line no-param-reassign\n        menuItem.rule = {\n          entity: this.forms[menuItem.form].entity,\n          method: 'put',\n        };\n      }\n      if (icons[menuItem.form]) {\n        // eslint-disable-next-line no-param-reassign\n        menuItem.icon = icons[menuItem.form];\n      }\n    });\n\n    // Admin <- Role.put\n    // PM <- Project.put\n    // User <- !Account.put\n\n    // this.memoryCollectMode = true;\n    this.memory = memory;\n  }\n};\nAppClient.package = packageName;\nexport default AppClient;\n","import KateJSClient from 'katejs/lib/client';\r\n\r\nimport AppClient from './AppClient';\r\nimport translations from './translations';\r\n\r\nKateJSClient({ AppClient, translations });\r\n","// import { translations } from 'katejs/lib/client';\r\n\r\n/* eslint-disable quote-props */\r\nconst translate = undefined;\r\n// {\r\n//   languages: ['ru'],\r\n//   ru: {\r\n//     ...translations.ru,\r\n//     'Tasks': 'Задачи',\r\n//   },\r\n// };\r\n\r\nexport default translate;\r\n"],"sourceRoot":""}