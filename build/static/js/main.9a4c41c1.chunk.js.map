{"version":3,"sources":["katejs-memory/lib/forms/CacheControl.js","katejs-memory/lib/AppClient.js","katejs-memory/lib/structure.js","forms/AccountList.js","forms/AccountItem.js","structure.js","icons.js","AppClient.js","index.js","translations.js"],"names":["CacheControl","args","title","save","app","memory","elements","type","Elements","BUTTON","onClick","Form","AppClient","parent","params","forms","makeApiLinks","entities","window","localStorage","setItem","this","memoryCollectMode","menu","push","form","url","uri","replace","baseUrl","body","JSON","stringify","auth","authorization","memItem","find","item","response","console","log","length","error","message","use","package","actions","disabled","unshift","GRID","LABEL","style","textAlign","marginTop","getElement","name","Fields","REFERENCE","entity","onChange","val","projectChange","currentProject","filters","projectUuid","uuid","get","value","project","content","__Add","allow","load","forEach","action","index","hidden","tag","id","ProjectRole","fields","STRING","Project","tables","Account","structures","ProjectList","xmlns","version","width","height","viewBox","d","ProjectRoleList","AccountList","env","apiUrl","init","addToMenu","AccountItem","saveAuth","menuItem","rule","method","icons","icon","AppUser","AppMemory","path","KateJSClient","translations","undefined"],"mappings":"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","file":"static/js/main.9a4c41c1.chunk.js","sourcesContent":["import { Form, Elements } from 'katejs/lib/client';\r\n\r\nexport default class CacheControl extends Form {\r\n  title = 'Cache control';\r\n\r\n  constructor(args) {\r\n    super(args);\r\n    this.elements = [\r\n      {\r\n        type: Elements.BUTTON,\r\n        title: 'Save cache',\r\n        onClick: this.save,\r\n      },\r\n    ];\r\n  }\r\n\r\n  save = () => {\r\n    this.app.CacheControl.save(this.app.memory);\r\n  }\r\n}\r\n","import { use } from 'katejs/lib/client';\r\n\r\nimport { packageName } from './structure';\r\nimport CacheControl from './forms/CacheControl';\r\n\r\nconst AppClient = parent => class Client extends use(parent) {\r\n  constructor(params) {\r\n    super(params);\r\n\r\n    this.forms = {\r\n      ...this.forms,\r\n      CacheControl,\r\n    };\r\n    this.makeApiLinks({ entities: ['CacheControl'] });\r\n    this.memory = [];\r\n    // set same device for all to proceed auth\r\n    window.localStorage.setItem('katejs-user-device', 'device-12345');\r\n  }\r\n\r\n  afterInit() {\r\n    if (super.afterInit) super.afterInit();\r\n    if (this.memoryCollectMode) {\r\n      this.menu.push({\r\n        form: 'CacheControl',\r\n        title: 'Cache control',\r\n      });\r\n    }\r\n  }\r\n\r\n  async request(url, params) {\r\n    const uri = url.replace(this.baseUrl, '');\r\n    const body = JSON.stringify(params.body);\r\n    const auth = this.authorization;\r\n    const memItem = this.memory.find(item => item.uri === uri\r\n      && item.body === body && item.auth === auth);\r\n    \r\n    let response;\r\n    if (this.memoryCollectMode) {\r\n      response = await super.request(url, params);\r\n      if (uri === '/CacheControl/save') return response;\r\n      if (memItem) {\r\n        memItem.response = response;\r\n      } else {\r\n        this.memory.push({\r\n          uri,\r\n          body,\r\n          auth,\r\n          response,\r\n        });\r\n        // eslint-disable-next-line no-console\r\n        console.log(`Added to cache (${this.memory.length})`);\r\n      }\r\n    } else if (memItem) {\r\n      // return saved data\r\n      // eslint-disable-next-line prefer-destructuring\r\n      response = memItem.response;\r\n    } else {\r\n      response = { error: { message: 'No data' } };\r\n    }\r\n    return response;\r\n  }\r\n};\r\nAppClient.package = packageName;\r\nexport default AppClient;\r\n","// eslint-disable-next-line import/prefer-default-export\r\nexport const packageName = 'katejs-memory';\r\n","import { Elements, getElement } from 'katejs/lib/client';\r\nimport Fields from 'katejs/lib/fields';\r\n\r\nexport default Form => class AccountList extends Form {\r\n  constructor(args) {\r\n    super(args);\r\n    this.actions[0].disabled = true;\r\n    this.elements.unshift({\r\n      type: Elements.GRID,\r\n      elements: [\r\n        {\r\n          type: Elements.LABEL,\r\n          title: 'Select project:',\r\n          style: { textAlign: 'right', marginTop: '30px' },\r\n        },\r\n        {\r\n          ...getElement({ name: 'project', type: Fields.REFERENCE, entity: 'Project' }, this),\r\n          onChange: val => this.projectChange(val),\r\n        },\r\n      ],\r\n    });\r\n    if (this.app.currentProject) {\r\n      this.filters = { projectUuid: this.app.currentProject.uuid };\r\n      this.elements.get('project').value = this.app.currentProject;\r\n      this.actions[0].disabled = false;\r\n    }\r\n  }\r\n\r\n  projectChange(project) {\r\n    this.filters = { projectUuid: project && project.uuid };\r\n    if (!project) this.filters = {};\r\n    this.content.__Add.disabled = !project || !this.app.allow('Account', 'put');\r\n    // to use in edit form\r\n    this.app.currentProject = project;\r\n    this.load();\r\n  }\r\n};\r\n","import { Elements } from 'katejs/lib/client';\r\n\r\nexport default Form => class AccountItem extends Form {\r\n  constructor(args) {\r\n    super(args);\r\n\r\n    this.elements.get('project').value = this.app.currentProject;\r\n    if (!this.app.allow('Account', 'put')) {\r\n      // user can only view\r\n      this.actions.forEach((action, index) => {\r\n        if (index === this.actions.length - 1) return;\r\n        // eslint-disable-next-line no-param-reassign\r\n        action.hidden = true;\r\n      });\r\n      // value will be set by id\r\n      this.elements = [\r\n        {\r\n          type: Elements.LABEL,\r\n          tag: 'h3',\r\n          id: 'title',\r\n        },\r\n        {\r\n          type: Elements.LABEL,\r\n          id: 'description',\r\n        },\r\n        {\r\n          type: Elements.GRID,\r\n          elements: [\r\n            {\r\n              type: Elements.LABEL,\r\n              title: 'Uri',\r\n            },\r\n            {\r\n              type: Elements.LABEL,\r\n              id: 'uri',\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          type: Elements.GRID,\r\n          elements: [\r\n            {\r\n              type: Elements.LABEL,\r\n              title: 'Login',\r\n            },\r\n            {\r\n              type: Elements.LABEL,\r\n              id: 'login',\r\n            },\r\n          ],\r\n        },\r\n        {\r\n          type: Elements.GRID,\r\n          elements: [\r\n            {\r\n              type: Elements.LABEL,\r\n              title: 'Password',\r\n            },\r\n            {\r\n              type: Elements.LABEL,\r\n              id: 'password',\r\n            },\r\n          ],\r\n        },\r\n      ];\r\n    }\r\n  }\r\n};\r\n","import Fields from 'katejs/lib/fields';\r\n\r\nconst ProjectRole = {\r\n  fields: [\r\n    {\r\n      name: 'title',\r\n      type: Fields.STRING,\r\n    },\r\n  ],\r\n};\r\n\r\nconst Project = {\r\n  fields: [\r\n    {\r\n      name: 'title',\r\n      type: Fields.STRING,\r\n    },\r\n  ],\r\n  tables: [\r\n    {\r\n      name: 'users',\r\n      fields: [\r\n        {\r\n          name: 'user',\r\n          type: Fields.REFERENCE,\r\n          entity: 'User',\r\n        },\r\n        {\r\n          name: 'role',\r\n          type: Fields.REFERENCE,\r\n          entity: 'ProjectRole',\r\n        },\r\n      ],\r\n    },\r\n  ],\r\n};\r\n\r\nconst Account = {\r\n  fields: [\r\n    {\r\n      name: 'title',\r\n      type: Fields.STRING,\r\n    },\r\n    {\r\n      name: 'project',\r\n      type: Fields.REFERENCE,\r\n      entity: 'Project',\r\n    },\r\n    {\r\n      name: 'description',\r\n      type: Fields.STRING,\r\n    },\r\n    {\r\n      name: 'url',\r\n      type: Fields.STRING,\r\n    },\r\n    {\r\n      name: 'login',\r\n      type: Fields.STRING,\r\n    },\r\n    {\r\n      name: 'password',\r\n      type: Fields.STRING,\r\n    },\r\n  ],\r\n  tables: [\r\n    {\r\n      name: 'availableFor',\r\n      fields: [\r\n        {\r\n          name: 'role',\r\n          type: Fields.REFERENCE,\r\n          entity: 'ProjectRole',\r\n        },\r\n      ],\r\n    },\r\n  ],\r\n};\r\n\r\n\r\nexport const title = 'Passstore';\r\nexport const packageName = 'passstore_app';\r\nexport const structures = {\r\n  ProjectRole,\r\n  Project,\r\n  Account,\r\n};\r\n","// eslint-disable-next-line import/no-extraneous-dependencies\r\nimport React from 'react';\r\n\r\nconst ProjectList = () => (\r\n  <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\r\n    <path d=\"M9,5V9H21V5M9,19H21V15H9M9,14H21V10H9M4,9H8V5H4M4,19H8V15H4M4,14H8V10H4V14Z\" />\r\n  </svg>\r\n);\r\n\r\nconst ProjectRoleList = () => (\r\n  <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\r\n    <path d=\"M13.07 10.41A5 5 0 0 0 13.07 4.59A3.39 3.39 0 0 1 15 4A3.5 3.5 0 0 1 15 11A3.39 3.39 0 0 1 13.07 10.41M5.5 7.5A3.5 3.5 0 1 1 9 11A3.5 3.5 0 0 1 5.5 7.5M7.5 7.5A1.5 1.5 0 1 0 9 6A1.5 1.5 0 0 0 7.5 7.5M16 17V19H2V17S2 13 9 13 16 17 16 17M14 17C13.86 16.22 12.67 15 9 15S4.07 16.31 4 17M15.95 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13Z\" />\r\n  </svg>\r\n);\r\n\r\nconst AccountList = () => (\r\n  <svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\r\n    <path d=\"M6.5,2C8.46,2 10.13,3.25 10.74,5H22V8H18V11H15V8H10.74C10.13,9.75 8.46,11 6.5,11C4,11 2,9 2,6.5C2,4 4,2 6.5,2M6.5,5A1.5,1.5 0 0,0 5,6.5A1.5,1.5 0 0,0 6.5,8A1.5,1.5 0 0,0 8,6.5A1.5,1.5 0 0,0 6.5,5M6.5,13C8.46,13 10.13,14.25 10.74,16H22V19H20V22H18V19H16V22H13V19H10.74C10.13,20.75 8.46,22 6.5,22C4,22 2,20 2,17.5C2,15 4,13 6.5,13M6.5,16A1.5,1.5 0 0,0 5,17.5A1.5,1.5 0 0,0 6.5,19A1.5,1.5 0 0,0 8,17.5A1.5,1.5 0 0,0 6.5,16Z\" />\r\n  </svg>\r\n);\r\n\r\nexport default {\r\n  ProjectList,\r\n  ProjectRoleList,\r\n  AccountList,\r\n};\r\n","import { use } from 'katejs/lib/client';\r\nimport { AppUser } from 'katejs-modules/lib/client';\r\n\r\nimport { AppMemory } from 'katejs-memory/lib/client';\r\n\r\nimport AccountList from './forms/AccountList';\r\nimport AccountItem from './forms/AccountItem';\r\n\r\nimport { structures, title, packageName } from './structure';\r\nimport env from './front.env.json';\r\nimport icons from './icons';\r\n\r\nimport memory from './memory.json';\r\n\r\nconst AppClient = parent => class Client extends use(parent, AppUser, AppMemory) {\r\n  static title = title;\r\n\r\n  static path = '/app';\r\n\r\n  constructor(params) {\r\n    super(params);\r\n    this.baseUrl = env.apiUrl || '/api';\r\n\r\n    this.init({ structures, addToMenu: true });\r\n\r\n    this.forms = {\r\n      ...this.forms,\r\n      AccountList: AccountList(this.forms.AccountList),\r\n      AccountItem: AccountItem(this.forms.AccountItem),\r\n    };\r\n\r\n    this.saveAuth = true;\r\n    this.menu.forEach((menuItem) => {\r\n      if (this.forms[menuItem.form].entity && this.forms[menuItem.form].entity !== 'Account') {\r\n        // eslint-disable-next-line no-param-reassign\r\n        menuItem.rule = {\r\n          entity: this.forms[menuItem.form].entity,\r\n          method: 'put',\r\n        };\r\n      }\r\n      if (icons[menuItem.form]) {\r\n        // eslint-disable-next-line no-param-reassign\r\n        menuItem.icon = icons[menuItem.form];\r\n      }\r\n    });\r\n\r\n    // Admin <- Role.put\r\n    // PM <- Project.put\r\n    // User <- !Account.put\r\n\r\n    // this.memoryCollectMode = true;\r\n    this.memory = memory;\r\n  }\r\n};\r\nAppClient.package = packageName;\r\nexport default AppClient;\r\n","import KateJSClient from 'katejs/lib/client';\r\n\r\nimport AppClient from './AppClient';\r\nimport translations from './translations';\r\n\r\nKateJSClient({ AppClient, translations });\r\n","// import { translations } from 'katejs/lib/client';\r\n\r\n/* eslint-disable quote-props */\r\nconst translate = undefined;\r\n// {\r\n//   languages: ['ru'],\r\n//   ru: {\r\n//     ...translations.ru,\r\n//     'Tasks': 'Задачи',\r\n//   },\r\n// };\r\n\r\nexport default translate;\r\n"],"sourceRoot":""}